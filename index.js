import{a as k,S as Z,j as R}from"./assets/vendor-Dy14UFr0.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".mob-menu-btn"),t=document.querySelector(".menu-close-btn"),n=document.querySelector("#mobileMenu"),r=document.body;e==null||e.addEventListener("click",()=>{n.classList.add("is-open"),r.classList.add("menu-open")}),t==null||t.addEventListener("click",o),n==null||n.addEventListener("click",a=>{a.target===n&&o()}),document.addEventListener("keydown",a=>{a.key==="Escape"&&n.classList.contains("is-open")&&o()}),document.querySelectorAll(".mobile-link").forEach(a=>{a.addEventListener("click",o)});function o(){n.classList.remove("is-open"),r.classList.remove("menu-open")}window.addEventListener("scroll",()=>{window.scrollY>50?document.querySelector(".header").classList.add("scrolled"):document.querySelector(".header").classList.remove("scrolled")})});const i={modal:document.querySelector(".modal"),artistDataLoader:document.getElementById("artistDataLoader"),artistDataSpinner:document.querySelector("#artistDataLoader .artist-loader__spinner"),artist:{name:document.querySelector(".modal__artist-name"),thumb:document.querySelector(".modal__artist-thumb"),years:document.querySelector(".modal__artist-years"),gender:document.querySelector(".modal__artist-gender"),members:document.querySelector(".modal__artist-members"),country:document.querySelector(".modal__artist-country"),bio:document.querySelector(".modal__artist-bio"),genres:document.querySelector(".modal__artist-genres")},albums:{container:document.querySelector(".modal__albums-container")},artistCardSection:document.querySelector(".modal__artist")};function D(){i.modal.classList.add("modal--hidden"),document.body.classList.remove("no-scroll"),document.body.style.overflow="",document.documentElement.style.overflow="",document.removeEventListener("keydown",Y)}function J(){const e=document.querySelector(".modal__close-btn"),t=document.querySelector(".modal");e&&e.addEventListener("click",D),t&&t.addEventListener("click",n=>{n.target===t&&D()})}function Y(e){e.key==="Escape"&&!i.modal.classList.contains("modal--hidden")&&D()}async function X(e){if(!e)throw new Error("Artist ID is required");const[t,n]=await Promise.all([k.get(`https://sound-wave.b.goit.study/api/artists/${e}`),k.get("https://sound-wave.b.goit.study/api/artists")]),r=t.data,o=n.data.artists||[];if(!(r!=null&&r.strArtist))throw new Error("No artist data");const a=o.find(c=>c._id===e);return a?a.genres&&(r.genres=a.genres):console.warn("Artist not found ❗️:",e),r}function ee(e){const t=Math.floor(e/1e3),n=Math.floor(t/60),r=t%60;return`${n}:${r.toString().padStart(2,"0")}`}function te(e,t){return e.reduce((n,r)=>{if(r.strArtist!==t)return n;const o=r.strAlbum||"Unknown Album";return n[o]||(n[o]=[]),n[o].push(r),n},{})}const U="/artistsHUB-team-project/assets/icons-CpGbVOcR.svg";function ne(e,t){const n=i.albums.container;if(!n)return;const r=te(e,t);n.innerHTML="";const o=document.createElement("ul");o.classList.add("modal__albums-list");for(const[a,c]of Object.entries(r)){const l=document.createElement("li");l.className="modal__album-item";const _=document.createElement("h4");_.className="modal__album-title",_.textContent=a,l.appendChild(_);const b=document.createElement("div");b.className="modal__tracks-wrapper";const L=document.createElement("ul");L.className="modal__tracks-header",L.innerHTML=`
      <li class="modal__track-name-col">track</li>
      <li class="modal__track-time-col">time</li>
      <li class="modal__track-link-col">link</li>
    `,b.appendChild(L),c.forEach(p=>{const h=document.createElement("ul");h.className="modal__track-item";const d=document.createElement("li");d.className="modal__track-name",d.textContent=p.strTrack||"";const E=document.createElement("li");E.className="modal__track-time",E.textContent=p.intDuration?ee(p.intDuration):"";const N=document.createElement("li");if(N.className="modal__track-link",p.movie){const S=document.createElement("a");S.href=p.movie,S.target="_blank",S.rel="noopener noreferrer",S.innerHTML=`
        <svg width="16" height="16">
          <use href="${U}#icon-youtube"></use>
        </svg>`,N.appendChild(S)}h.append(d,E,N),b.appendChild(h)}),l.appendChild(b),o.appendChild(l)}n.appendChild(o)}function re(e){const{name:t,thumb:n,years:r,gender:o,members:a,country:c,bio:l}=i.artist;t.textContent=e.strArtist??"No name",n.src=e.strArtistThumb||"https://via.placeholder.com/200x200?text=No+Image",n.alt=`Artist photo ${e.strArtist??""}`,l.textContent=e.strBiographyEN??"No description",r.textContent=e.intFormedYear?`${e.intFormedYear} - ${e.intDiedYear||"present"}`:"No data",o.textContent=e.strGender||"No data",a.textContent=e.intMembers||"No data",c.textContent=e.strCountry||"No data"}function se(e,t){if(!(e instanceof HTMLElement)){console.error("container not DOM-element:",e);return}if(e.innerHTML="",t&&t.length>0)t.forEach(n=>{const r=document.createElement("span");r.classList.add("modal__genres-item"),r.textContent=n,e.appendChild(r)});else{const n=document.createElement("span");n.classList.add("modal__genres-item"),n.textContent="Genres not available",e.appendChild(n)}}function oe(){if(!i.artistDataLoader||!i.artistCardSection){console.error("DOM references for loader are not found!");return}document.querySelector("#globalLoader").classList.remove("global-loader--hidden"),i.artistDataLoader.classList.remove("artist-loader--hidden"),i.artistDataLoader.classList.add("artist-loader--visible"),i.artistCardSection.classList.add("hidden")}function ae(){if(!i.artistDataLoader||!i.artistCardSection){console.error("DOM references for loader are not found!");return}document.querySelector("#globalLoader").classList.add("global-loader--hidden"),i.artistDataLoader.classList.remove("artist-loader--visible"),i.artistDataLoader.classList.add("artist-loader--hidden"),i.artistCardSection.classList.remove("hidden")}const P={showArtistLoader:oe,hideArtistLoader:ae};async function ie(e){try{P.showArtistLoader();const t=await X(e),n=t.genres||[];ce(),re(t),ne(t.tracksList,t.strArtist),se(i.artist.genres,n),P.hideArtistLoader(),i.modal.classList.remove("modal--hidden"),document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.addEventListener("keydown",Y)}catch(t){console.error("Error to load artist data:",t.message,t),P.hideArtistLoader(),alert("Artist data not found"),D()}}function ce(){i.albums.container&&(i.albums.container.innerHTML=""),i.artist.genres&&(i.artist.genres.innerHTML="")}J();const z="https://sound-wave.b.goit.study/api",w=document.querySelector(".artists__list"),m=document.querySelector(".artists__load-more-btn"),G=document.querySelector(".loader"),B=document.querySelector("[data-empty]"),y=document.querySelector("[data-genres-btn]"),u=document.querySelector("[data-genres-menu]"),g=document.querySelector("[data-sort-btn]"),f=document.querySelector("[data-sort-menu]"),j=document.querySelector("[data-search-form]"),I=document.querySelector("[data-search-input]"),H=document.querySelector("[data-reset-btn]"),s={page:1,limit:8,genre:"",sort:"",search:"",clientPool:[],clientMode:!1,clientPoolLimit:120};function x(e){G&&G.classList.toggle("visually-hidden",!e)}function C(e){B&&B.classList.toggle("visually-hidden",!e)}function A(){u==null||u.classList.remove("is-open"),f==null||f.classList.remove("is-open")}function K(e){const t=e.classList.contains("is-open");A(),t||e.classList.add("is-open")}document.addEventListener("click",e=>{(y==null?void 0:y.contains(e.target))||(u==null?void 0:u.contains(e.target))||(g==null?void 0:g.contains(e.target))||(f==null?void 0:f.contains(e.target))||A()});function le(e,t){if(typeof e!="string")return"";const n=window.innerWidth;return n<768?t=60:n<1440?t=160:t=144,e.length>t?e.slice(0,t)+"...":e}function de(e){return typeof e!="string"?"":e.replace(/[,/]/g," ")}function T(e){return e.map(({_id:t,genres:n,strArtist:r,strArtistThumb:o,strBiographyEN:a})=>`
      <li class="artists__card">
        <img class="artists__card-image" src="${o}" alt="${r}"/>

        <ul class="artists__card-genres">
          ${(n||[]).map(c=>`<li class="artists__card-genre">${de(c)}</li>`).join("")}
        </ul>

        <p class="artists__card-name">${r||""}</p>
        <p class="artists__card-description">${le(a,144)}</p>

        <button class="artists__card-btn open-artist-modal" data-artist-id="${t}">
          Learn More
          <svg class="artists__card-btn-icon" width="24" height="24">
            <use href="${U}#icon-caret-right"></use>
          </svg>
        </button>
      </li>
    `).join("")||""}async function F({page:e,limit:t,genre:n,sort:r,search:o}){var l;const a={page:e,limit:t};return n&&(a.genre=n),o&&(a.search=o),r&&(a.sort=r),((l=(await k.get(`${z}/artists`,{params:a})).data)==null?void 0:l.artists)||[]}async function ue(){const t=(await k.get(`${z}/genres`)).data;return(Array.isArray(t)?t:(t==null?void 0:t.genres)||[]).map(r=>typeof r=="string"?r:(r==null?void 0:r.name)||(r==null?void 0:r.genre)||"").filter(Boolean)}function Q(e){let t=[...e];if(s.genre&&(t=t.filter(n=>(n.genres||[]).includes(s.genre))),s.search){const n=s.search.toLowerCase();t=t.filter(r=>(r.strArtist||"").toLowerCase().includes(n))}return s.sort==="asc"&&t.sort((n,r)=>(n.strArtist||"").localeCompare(r.strArtist||"")),s.sort==="desc"&&t.sort((n,r)=>(r.strArtist||"").localeCompare(n.strArtist||"")),t}async function me(){const e=Math.ceil(s.clientPoolLimit/s.limit),t=[];for(let n=1;n<=e;n+=1){const r=await F({page:n,limit:s.limit,genre:"",sort:"",search:""});t.push(...r)}s.clientPool=t}async function q(){x(!0),C(!1);try{s.page=1,s.clientMode=!!(s.genre||s.sort||s.search);let e=[];if(s.clientMode){s.clientPool.length||await me();const t=Q(s.clientPool),n=0,r=s.limit;e=t.slice(n,r),w.innerHTML=T(e),C(t.length===0),m.style.display=t.length>r?"flex":"none"}else{const t=await F({page:s.page,limit:s.limit,genre:s.genre,sort:s.sort,search:s.search});w.innerHTML=T(t),C(t.length===0),m.style.display=t.length?"flex":"none"}}catch(e){console.log(e),C(!0),m.style.display="none"}finally{x(!1)}}async function fe(){x(!0);try{if(s.page+=1,s.clientMode){const e=Q(s.clientPool),t=(s.page-1)*s.limit,n=s.page*s.limit,r=e.slice(t,n);if(!r.length){m.style.display="none";return}w.insertAdjacentHTML("beforeend",T(r)),m.style.display=e.length>n?"flex":"none"}else{const e=await F({page:s.page,limit:s.limit,genre:s.genre,sort:s.sort,search:s.search});if(!e.length){m.style.display="none";return}w.insertAdjacentHTML("beforeend",T(e)),m.style.display="flex"}}catch(e){console.log(e)}finally{x(!1)}}w.addEventListener("click",e=>{const t=e.target.closest(".open-artist-modal");if(!t)return;const n=t.dataset.artistId;n&&ie(n)});y==null||y.addEventListener("click",()=>K(u));g==null||g.addEventListener("click",()=>K(f));u==null||u.addEventListener("click",e=>{const t=e.target.closest("[data-genre]");t&&(s.genre=t.dataset.genre||"",s.page=1,y.textContent=s.genre?s.genre:"Genres",s.clientPool=[],A(),q())});f==null||f.addEventListener("click",e=>{const t=e.target.closest("[data-sort]");t&&(s.sort=t.dataset.sort||"",s.page=1,g.textContent=s.sort==="asc"?"A–Z":s.sort==="desc"?"Z–A":"Sort",s.clientPool=[],A(),q())});j==null||j.addEventListener("submit",e=>{e.preventDefault(),s.search=(I.value||"").trim(),s.page=1,s.clientPool=[],q()});H==null||H.addEventListener("click",()=>{s.genre="",s.sort="",s.search="",s.page=1,s.clientMode=!1,s.clientPool=[],I&&(I.value=""),y&&(y.textContent="Genres"),g&&(g.textContent="Sort"),A(),q()});m==null||m.addEventListener("click",fe);async function pe(){try{const t=['<li class="dropdown__item" data-genre="">All genres</li>',...(await ue()).map(n=>`<li class="dropdown__item" data-genre="${n}">${n}</li>`)];u.innerHTML=t.join("")}catch(e){console.log(e),u.innerHTML='<li class="dropdown__item" data-genre="">All genres</li>'}}pe();q();const ye="https://sound-wave.b.goit.study/api/feedbacks?limit=10&page=1";async function ge(e){try{return(await k.get(e)).data}catch(t){console.log(t)}}function he(e){const t=e.map(r=>`
      <li class="swiper-slide item-feedback">
        <div class="stars-rating-feedback" data-rating="${Math.round(r.rating)}"></div>
        <p class="text-feedback">${r.descr}</p>
        <p class="text-name-feedback">${r.name}</p>
      </li>
    `).join(""),n=document.getElementById("card-list-feedback");n.innerHTML="",n.insertAdjacentHTML("beforeend",t)}function be(){return new Z(".feedback-swiper",{slidesPerView:1,spaceBetween:24,loop:!1,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},pagination:{el:".feedback-pagination",clickable:!0,renderBullet(e,t){return e===0?`<span class="${t} pagination-start"></span>`:e===9?`<span class="${t} pagination-end"></span>`:`<span class="${t} pagination-middle"></span>`}}})}function Le(){document.querySelectorAll(".stars-rating-feedback").forEach(t=>{const n=Number(t.dataset.rating);$(t).raty({score:n,readOnly:!0,half:!1,starType:"i"})})}ge(ye).then(e=>{const t=e.data;!t||t.length===0||(he(t),Le(),be())}).catch(e=>console.log(e));function ve(){document.body.classList.add("body-no-scroll")}function _e(){document.body.classList.remove("body-no-scroll")}function O(e,t){e.classList.add("feedback-error");let n=e.parentElement.querySelector(".feedback-error-text");n||(n=document.createElement("div"),n.className="feedback-error-text",e.parentElement.appendChild(n)),n.textContent=t}function V(e){e.classList.remove("feedback-error");const t=e.parentElement.querySelector(".feedback-error-text");t&&t.remove()}function W(){document.querySelectorAll(".feedback-error").forEach(t=>{V(t)});const e=document.querySelector(".server-error-message");e&&e.remove()}const v=document.querySelector(".js-feedback-backdrop");function Ee(){v.removeAttribute("hidden"),ve(),W()}function M(){v.setAttribute("hidden",""),_e()}function Se(){const e=document.querySelector(".js-feedback-close");!v||!e||(e.addEventListener("click",M),v.addEventListener("click",t=>{t.target===v&&M()}),document.addEventListener("keydown",t=>{t.key==="Escape"&&!v.hasAttribute("hidden")&&M()}))}function ke(){const e=document.querySelector(".feedback-btn");e&&e.addEventListener("click",t=>{t.preventDefault(),Ee()})}function we(){const e=document.querySelector(".rating");if(!e)return;const t=e.querySelectorAll(".rating-star"),n=document.getElementById("rating-input");t.forEach(r=>{r.addEventListener("click",o=>{o.preventDefault();const a=Number(r.dataset.value);n.value=a,t.forEach(c=>{c.classList.toggle("active",Number(c.dataset.value)<=a)}),V(e)})})}function Ae(){const e=document.querySelector(".js-feedback-form");if(!e)return;const t=e.querySelector('[name="name"]'),n=e.querySelector('[name="message"]'),r=document.getElementById("rating-input"),o=e.querySelector(".rating"),a=e.querySelector(".feedback-submit-btn"),c=e.querySelector(".js-submit-text"),l=e.querySelector(".js-submit-loader");e.addEventListener("submit",async _=>{_.preventDefault(),W();const b=t.value.trim(),L=n.value.trim(),p=Number(r.value);let h=!0;if(b||(O(t,"Імʼя обовʼязкове"),h=!1),(!L||L.length<10)&&(O(n,"Мінімум 10 символів"),h=!1),(p<1||p>5)&&(O(o,"Оберіть рейтинг"),h=!1),!!h){a.disabled=!0,c.hidden=!0,l.hidden=!1;try{if(!(await fetch("https://sound-wave.b.goit.study/api/feedbacks",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:b,rating:p,descr:L})})).ok)throw new Error("Server error");e.reset(),r.value="0",document.querySelectorAll(".rating-star").forEach(E=>E.classList.remove("active")),M(),alert("Дякуємо за відгук!")}catch{const d=document.createElement("div");d.className="server-error-message",d.textContent="Помилка відправки",d.style.color="#dc2626",d.style.textAlign="center",d.style.marginTop="16px",e.appendChild(d),setTimeout(()=>d.remove(),5e3)}finally{a.disabled=!1,c.hidden=!1,l.hidden=!0}}})}document.addEventListener("DOMContentLoaded",()=>{Se(),ke(),we(),Ae()});window.$=R;window.jQuery=R;
//# sourceMappingURL=index.js.map
